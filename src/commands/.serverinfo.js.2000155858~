const { SlashCommandBuilder, EmbedBuilder } = require("discord.js");
const embeds = require("./../../config/embeds.json");
const emojis = require("./../../config/emojis.json");

module.exports = {
	data: new SlashCommandBuilder()
		.setName('serverinfo')
		.setDescription('Some information about the server'),
	async execute(interaction, client) {

const guild = client.guilds.cache.get(interaction.guildId);
    const totalMembers = guild.members.cache.size;
    const onlineMembers = guild.members.cache.filter(
      (member) => member.presence?.status !== 'offline'
    ).size;
    const textChannels = guild.channels.cache.filter(
      (channel) => channel.type === 'GUILD_TEXT'
    ).size;
    const voiceChannels = guild.channels.cache.filter(
      (channel) => channel.type === 'GUILD_VOICE'
    ).size;
    const serverCreationDate = guild.createdAt.toDateString();
    const botCount = guild.members.cache.filter((member) => member.user.bot).size;
    const verificationLevel = guild.verificationLevel;
    const owner = await client.users.fetch(guild.ownerId);
    const ownerUsername = owner.username;
    const roleCount = guild.roles.cache.size;
    const isCommunityServer = verificationLevel === 'VERY_HIGH' || verificationLevel === 'HIGH';

    const communityIndicator = isCommunityServer ? '✅' : '❌';

const embed = new EmbedBuilder()
  .setColor(embeds.color)
    .setTitle(`**${guild.name}'s Info**`)
.setDescription(`**Server Name: ${guild.name}

Owner: ${ownerUsername}

Total Members: ${totalMembers}

Bot Count: ${botCount}

Online Members: ${onlineMembers}

Text Channels: ${textChannels}

Voice Channels: ${voiceChannels}

Role Count: ${roleCount}

Verification Level: ${verificationLevel}

Community Server: ${communityIndicator}

Server Creation Date: ${serverCreationDate}
**`)
  .setFooter({text: `${embeds.footer}`})
   .setTimestamp();

return interaction.editReply({embeds: [embed]})
    
	},
};
